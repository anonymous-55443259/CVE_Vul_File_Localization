[{"role": "system", "content": "You are a software vulnerability expert familiar with Common Vulnerabilities and Exposures (CVE) in the National Vulnerability Database (NVD). You will be given a CVE description and some supplementary information about the vulnerability.\n\nYour task is to extract the key content from the supplementary information and integrate it into the original description. The key content includes:\n* The software components within a software product that are affected by the vulnerability, e.g. file name, function name, and module name;\n* An explanation of an attack type using the vulnerability;\n* Any attack vectors that can make use of the vulnerabilit;\n* The impact of the vulnerability;\n\nDescriptions often follow this template: [VULNTYPE] in [COMPONENT] in [VENDOR] [PRODUCT] [VERSION] allows [ATTACKER] to [IMPACT] via [VECTOR].\n**The output should be a complete paragraph.**\n**Add new content, do not delete the original description.**\n\nThe supplementary information provided may be minimal or missing, you can use two tools:\n* google_search: Search for key terms mentioned in the original description.\n* access_web_page: Retrieve the content of a specified web page, either from the supplementary information or from Google search results."}, {"role": "user", "content": "# original description:\nThe signal handling in the Linux kernel before 2.6.22, including 2.6.2, when running on PowerPC systems using HTX, allows local users to cause a denial of service via unspecified vectors involving floating point corruption and concurrency, related to clearing of MSR bits.\n# supplementary information:\nTitle:\nCVE-2007-3107 Data buffer miscompare on PowerPC when running HTX\n\nAttributes:\nKeywords:\nSecurity\nStatus:\nCLOSED\n          ERRATA\nAlias:\n        None\nProduct:\nRed Hat Enterprise Linux 5\nClassification:\nRed Hat\nComponent:\nkernel\nSub Component:\n---\nStorage\n\u00a0\u00a0\u00a0\u00a0Multiple Devices (MD)\n\u00a0\u00a0\u00a0\u00a0Device Mapper\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Core\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Crypt\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Multipath\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0RAID\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Snapshots\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Other\n\u00a0\u00a0\u00a0\u00a0Storage Drivers\n\u00a0\u00a0\u00a0\u00a0Other\nFile Systems\n\u00a0\u00a0\u00a0\u00a0VFS\n\u00a0\u00a0\u00a0\u00a0GFS/GFS2\n\u00a0\u00a0\u00a0\u00a0XFS\n\u00a0\u00a0\u00a0\u00a0ext*\n\u00a0\u00a0\u00a0\u00a0NFS\n\u00a0\u00a0\u00a0\u00a0CIFS\n\u00a0\u00a0\u00a0\u00a0AutoFS\n\u00a0\u00a0\u00a0\u00a0Other\nNetworking\n\u00a0\u00a0\u00a0\u00a0Bluetooth\n\u00a0\u00a0\u00a0\u00a0Wifi\n\u00a0\u00a0\u00a0\u00a0Protocol\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0sctp\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0igmp/mld\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0tcp\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0udp\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0arp/icmp\n\u00a0\u00a0\u00a0\u00a0IPv6\n\u00a0\u00a0\u00a0\u00a0NIC Drivers\n\u00a0\u00a0\u00a0\u00a0Vlan\n\u00a0\u00a0\u00a0\u00a0Bonding\n\u00a0\u00a0\u00a0\u00a0Team\n\u00a0\u00a0\u00a0\u00a0Bridge\n\u00a0\u00a0\u00a0\u00a0OVS\n\u00a0\u00a0\u00a0\u00a0Tunnel\n\u00a0\u00a0\u00a0\u00a0IPSec/Crypto\n\u00a0\u00a0\u00a0\u00a0Netfilter\n\u00a0\u00a0\u00a0\u00a0PTP\n\u00a0\u00a0\u00a0\u00a0Misc\nPower Management\nDesktop\n\u00a0\u00a0\u00a0\u00a0Graphics\n\u00a0\u00a0\u00a0\u00a0Audio\n\u00a0\u00a0\u00a0\u00a0V4L\n\u00a0\u00a0\u00a0\u00a0fbdev\n\u00a0\u00a0\u00a0\u00a0USB\n\u00a0\u00a0\u00a0\u00a0Other\nVirtualization\n\u00a0\u00a0\u00a0\u00a0Xen\n\u00a0\u00a0\u00a0\u00a0ESXi\n\u00a0\u00a0\u00a0\u00a0Hyper-V\n\u00a0\u00a0\u00a0\u00a0KVM\n\u00a0\u00a0\u00a0\u00a0Other\nDebugging/Tracing\n\u00a0\u00a0\u00a0\u00a0Kexec/kdump\n\u00a0\u00a0\u00a0\u00a0Utrace/Uprobe/Ptrace\n\u00a0\u00a0\u00a0\u00a0EDAC/HERM\n\u00a0\u00a0\u00a0\u00a0Oprofile\n\u00a0\u00a0\u00a0\u00a0Systemtap\n\u00a0\u00a0\u00a0\u00a0Locking/lockdep\nPlatform Enablement\nInfiniband\nSecurity\n\u00a0\u00a0\u00a0\u00a0ASLR\n\u00a0\u00a0\u00a0\u00a0IMA\n\u00a0\u00a0\u00a0\u00a0KASLR\n\u00a0\u00a0\u00a0\u00a0SELinux\n\u00a0\u00a0\u00a0\u00a0Audit\n\u00a0\u00a0\u00a0\u00a0TPM\n\u00a0\u00a0\u00a0\u00a0Key Management\n\u00a0\u00a0\u00a0\u00a0Other\nMemory Management\nScheduler\nProcess management\nCrypto\nOther\nVersion:\n5.1\nHardware:\nppc64\nOS:\n        Linux\nPriority:\nurgent\nSeverity:\n       medium\nTarget Milestone:\n---\n            Target\u00a0Release:\n---\nAssignee:\nDon Howard\nQA Contact:\nMartin Jenner\nDocs Contact:\nURL:\nWhiteboard:\nimpact=moderate,source=redhat,reporte...\nDepends On:\n245332\nBlocks:\nTreeView+\n        depends on /\n        blocked\nReported:\n2007-06-25 15:13 UTC by Ludek Smid\nModified:\n2009-06-19 23:02 UTC\n      (History)\nCC List:\n8 \n          users\n            (show)\ndzickus\njturner\nkonradr\nmarcobillpeter\npeterm\nsecurity-response-team\nsmoser\ntao\nFixed In Version:\nRHSA-2007-0595\nDoc Type:\nBug Fix\nDoc Text:\nClone Of:\nEnvironment:\nLast Closed:\n2007-07-10 04:04:28 UTC\nTarget Upstream Version:\nEmbargoed:\n        Dependent Products:\nRed Hat Developer Toolset\nRed Hat OpenStack\nRed Hat Software Collections\n\n\nComments:\nDescription\nLudek Smid\n          2007-06-25 15:13:15 UTC\nThis bug has been copied from bug #245332 and has been proposed to be backported\nto 5.0 z-stream (EUS).\nComment 3\nMartin Jenner\n          2007-07-05 19:13:20 UTC\nKonrad,\nAny update on the status of IBM testing on with the 2.6.18-8.1.8.el5 kernel ?\nComment 4\nKonrad Rzeszutek\n          2007-07-05 20:07:59 UTC\nTesting of 2.6.18-8.1.8.el5 passed the  HTX test-suite successfully.\nComment 7\nMarcel Holtmann\n          2007-07-10 03:35:34 UTC\nWe think that we are getting a page fault or timer interrupt during one of the\n__copy_from_user calls in restore_sigcontext - the ones that write to\ncurrent->thread.fpr and current->thread.vr.  Since we aren't clearing MSR_FP\nand MSR_VEC until after the copy, switching to another process during the copy\nwill overwrite current->thread.fpr (assuming the signal handler used\nfloating-point instructions).  If we clear those MSR bits before copying into\ncurrent->thread.fpr and/or current->thread.vr, like the 32-bit code already\ndoes, we are safe -- and that's what we will do with this patch.\nThe bad news is that this bug was introduced in 2.6.2, so it is present in\nRHEL4, SLES9 and SLES10 as well...\nComment 8\nRed Hat Bugzilla\n          2007-07-10 04:04:28 UTC\nAn advisory has been issued which should help the problem\ndescribed in this bug report. This report is therefore being\nclosed with a resolution of ERRATA. For more information\non the solution and/or where to find the updated files,\nplease follow the link below. You may reopen this bug report\nif the solution does not work for you.\nhttp://rhn.redhat.com/errata/RHSA-2007-0595.html\nTitle:\nLinux kernel on PowerPC using HTX signal handling denial of service\n\nDetail:\nkernel-htx-signal-dos (35383)   \u62a5\u544a\u65f6\u95f4 Jun 25, 2007\nThe Linux kernel on PowerPC using HTX is vulnerable to a denial of service, caused by a vulnerability in the signal handling service. A local attacker could exploit this vulnerability to cause a denial of service.\n\nConsequences:\n\u7ed3\u679c\uff1a\nDenial of Service\n\nRemedy:\n\u8865\u6551\u63aa\u65bd\nFor Red Hat Linux:\nRefer to RHSA-2007:0595 for patch, upgrade, or suggested workaround information. See References.\n\nParameters:\nCVSS 1.0 \u4e34\u65f6\u5206\u6570\n1.8\n\u53ef\u5229\u7528\u6027 Unproven\n\nTitle:\nUSN-574-1: Linux kernel vulnerabilities\nLinux kernel vulnerabilities\nContent:\nReleases\nUbuntu 7.10\nUbuntu 7.04\nUbuntu 6.10\nPackages\nlinux-source-2.6.17 -\nlinux-source-2.6.20 -\nlinux-source-2.6.22 -\nDetails\nThe minix filesystem did not properly validate certain filesystem\nvalues. If a local attacker could trick the system into attempting\nto mount a corrupted minix filesystem, the kernel could be made to\nhang for long periods of time, resulting in a denial of service.\nThis was only vulnerable in Ubuntu 7.04 and 7.10. (CVE-2006-6058)\nThe signal handling on PowerPC systems using HTX allowed local users\nto cause a denial of service via floating point corruption. This was\nonly vulnerable in Ubuntu 6.10 and 7.04. (CVE-2007-3107)\nThe Linux kernel did not properly validate the hop-by-hop IPv6\nextended header. Remote attackers could send a crafted IPv6 packet\nand cause a denial of service via kernel panic. This was only\nvulnerable in Ubuntu 7.04. (CVE-2007-4567)\nThe JFFS2 filesystem with ACL support enabled did not properly store\npermissions during inode creation and ACL setting. Local users could\npossibly access restricted files after a remount.  This was only\nvulnerable in Ubuntu 7.04 and 7.10. (CVE-2007-4849)\nChris Evans discovered an issue with certain drivers that use the\nieee80211_rx function. Remote attackers could send a crafted 802.11\nframe and cause a denial of service via crash. This was only\nvulnerable in Ubuntu 7.04 and 7.10. (CVE-2007-4997)\nAlex Smith discovered an issue with the pwc driver for certain webcam\ndevices. A local user with physical access to the system could remove\nthe device while a userspace application had it open and cause the USB\nsubsystem to block. This was only vulnerable in Ubuntu 7.04.\n(CVE-2007-5093)\nScott James Remnant discovered a coding error in ptrace. Local users\ncould exploit this and cause the kernel to enter an infinite loop.\nThis was only vulnerable in Ubuntu 7.04 and 7.10. (CVE-2007-5500)\nIt was discovered that the Linux kernel could dereference a NULL\npointer when processing certain IPv4 TCP packets. A remote attacker\ncould send a crafted TCP ACK response and cause a denial of service\nvia crash. This was only vulnerable in Ubuntu 7.10. (CVE-2007-5501)\nWarren Togami discovered that the hrtimer subsystem did not properly\ncheck for large relative timeouts. A local user could exploit this and\ncause a denial of service via soft lockup. (CVE-2007-5966)\nVenustech AD-LAB discovered a buffer overflow in the isdn net\nsubsystem. This issue is exploitable by local users via crafted input\nto the isdn_ioctl function. (CVE-2007-6063)\nIt was discovered that the isdn subsystem did not properly check for\nNULL termination when performing ioctl handling. A local user could\nexploit this to cause a denial of service. (CVE-2007-6151)\nBlake Frantz discovered that when a root process overwrote an existing\ncore file, the resulting core file retained the previous core file's\nownership. Local users could exploit this to gain access to sensitive\ninformation. (CVE-2007-6206)\nHugh Dickins discovered the when using the tmpfs filesystem, under\nrare circumstances, a kernel page may be improperly cleared. A local\nuser may be able to exploit this and read sensitive kernel data or\ncause a denial of service via crash. (CVE-2007-6417)\nBill Roman discovered that the VFS subsystem did not properly check\naccess modes. A local user may be able to gain removal privileges on\ndirectories. (CVE-2008-0001)\nReduce your security exposure\nUbuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.\nLearn more about Ubuntu ProUpdate instructions\nThe problem can be corrected by updating your system to the following package versions:\nUbuntu 7.10\nlinux-image-2.6.22-14-itanium\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-xen\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-lpia\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-hppa32\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-powerpc-smp\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-386\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-mckinley\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-sparc64-smp\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-sparc64\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-generic\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-virtual\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-powerpc\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-cell\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-rt\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-hppa64\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-lpiacompat\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-ume\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-powerpc64-smp\n-\n2.6.22-14.51\nlinux-image-2.6.22-14-server\n-\n2.6.22-14.51\nUbuntu 7.04\nlinux-image-2.6.20-16-386\n-\n2.6.20-16.34\nlinux-image-2.6.20-16-powerpc\n-\n2.6.20-16.34\nlinux-image-2.6.20-16-server\n-\n2.6.20-16.34\nlinux-image-2.6.20-16-mckinley\n-\n2.6.20-16.34\nlinux-image-2.6.20-16-sparc64-smp\n-\n2.6.20-16.34\nlinux-image-2.6.20-16-hppa32\n-\n2.6.20-16.34\nlinux-image-2.6.20-16-powerpc64-smp\n-\n2.6.20-16.34\nlinux-image-2.6.20-16-itanium\n-\n2.6.20-16.34\nlinux-image-2.6.20-16-powerpc-smp\n-\n2.6.20-16.34\nlinux-image-2.6.20-16-generic\n-\n2.6.20-16.34\nlinux-image-2.6.20-16-sparc64\n-\n2.6.20-16.34\nlinux-image-2.6.20-16-hppa64\n-\n2.6.20-16.34\nlinux-image-2.6.20-16-lowlatency\n-\n2.6.20-16.34\nlinux-image-2.6.20-16-server-bigiron\n-\n2.6.20-16.34\nUbuntu 6.10\nlinux-image-2.6.17-12-mckinley\n-\n2.6.17.1-12.43\nlinux-image-2.6.17-12-powerpc64-smp\n-\n2.6.17.1-12.43\nlinux-image-2.6.17-12-hppa32\n-\n2.6.17.1-12.43\nlinux-image-2.6.17-12-hppa64\n-\n2.6.17.1-12.43\nlinux-image-2.6.17-12-sparc64-smp\n-\n2.6.17.1-12.43\nlinux-image-2.6.17-12-generic\n-\n2.6.17.1-12.43\nlinux-image-2.6.17-12-powerpc-smp\n-\n2.6.17.1-12.43\nlinux-image-2.6.17-12-386\n-\n2.6.17.1-12.43\nlinux-image-2.6.17-12-server-bigiron\n-\n2.6.17.1-12.43\nlinux-image-2.6.17-12-itanium\n-\n2.6.17.1-12.43\nlinux-image-2.6.17-12-powerpc\n-\n2.6.17.1-12.43\nlinux-image-2.6.17-12-sparc64\n-\n2.6.17.1-12.43\nlinux-image-2.6.17-12-server\n-\n2.6.17.1-12.43\nAfter a standard system upgrade you need to reboot your computer to\neffect the necessary changes.References\nCVE-2006-6058\nCVE-2007-3107\nCVE-2007-4567\nCVE-2007-4849\nCVE-2007-4997\nCVE-2007-5093\nCVE-2007-5500\nCVE-2007-5501\nCVE-2007-5966\nCVE-2007-6063\nCVE-2007-6151\nCVE-2007-6206\nCVE-2007-6417\nCVE-2008-0001Related notices\nUSN-578-1: linux-image-2.6.15-51-hppa32-smp, linux-image-2.6.15-51-itanium-smp, linux-image-2.6.15-51-powerpc64-smp, linux-image-2.6.15-51-sparc64-smp, linux-image-2.6.15-51-server-bigiron, linux-image-2.6.15-51-amd64-generic, linux-image-2.6.15-51-mckinley-smp, linux-source-2.6.15, linux-image-2.6.15-51-hppa32, linux-image-2.6.15-51-sparc64, linux-image-2.6.15-51-amd64-k8, linux-image-2.6.15-51-k7, linux-image-2.6.15-51-amd64-xeon, linux-image-2.6.15-51-hppa64-smp, linux-image-2.6.15-51-server, linux-image-2.6.15-51-hppa64, linux-image-2.6.15-51-powerpc, linux-image-2.6.15-51-itanium, linux-image-2.6.15-51-mckinley, linux-image-2.6.15-51-powerpc-smp, linux-image-2.6.15-51-386, linux-image-2.6.15-51-686, linux-image-2.6.15-51-amd64-server\nUSN-558-1: linux-image-2.6.17-12-server, linux-image-2.6.22-14-lpia, linux-image-2.6.22-14-rt, linux-image-2.6.22-14-powerpc, linux-image-2.6.17-12-386, linux-image-2.6.20-16-lowlatency, linux-image-2.6.22-14-sparc64-smp, linux-image-2.6.20-16-powerpc-smp, linux-image-2.6.22-14-hppa32, linux-image-2.6.17-12-hppa64, linux-image-2.6.20-16-server, linux-image-2.6.20-16-mckinley, linux-image-2.6.20-16-sparc64, linux-image-2.6.22-14-server, linux-image-2.6.22-14-xen, linux-image-2.6.17-12-itanium, linux-source-2.6.17, linux-image-2.6.22-14-ume, linux-image-2.6.17-12-sparc64-smp, linux-image-2.6.20-16-hppa64, linux-image-2.6.22-14-cell, linux-image-2.6.22-14-hppa64, linux-image-2.6.20-16-hppa32, linux-image-2.6.22-14-sparc64, linux-image-2.6.20-16-server-bigiron, linux-image-2.6.20-16-generic, linux-image-2.6.22-14-itanium, linux-image-2.6.20-16-386, linux-image-2.6.22-14-386, linux-image-2.6.22-14-generic, linux-image-2.6.17-12-powerpc64-smp, linux-image-2.6.22-14-virtual, linux-image-2.6.17-12-generic, linux-source-2.6.22, linux-image-2.6.20-16-itanium, linux-image-2.6.22-14-lpiacompat, linux-image-2.6.22-14-mckinley, linux-image-2.6.20-16-powerpc64-smp, linux-image-2.6.17-12-server-bigiron, linux-image-2.6.17-12-mckinley, linux-image-2.6.20-16-powerpc, linux-image-2.6.20-16-sparc64-smp, linux-image-2.6.17-12-sparc64, linux-image-2.6.22-14-powerpc64-smp, linux-image-2.6.17-12-powerpc-smp, linux-source-2.6.20, linux-image-2.6.17-12-powerpc, linux-image-2.6.17-12-hppa32, linux-image-2.6.22-14-powerpc-smp"}, {"role": "assistant", "content": "The signal handling vulnerability in the Linux kernel before version 2.6.22, specifically when running on PowerPC systems using HTX, allows local users to cause a denial of service. This issue arises due to improper handling of floating point corruption and concurrency related to the clearing of MSR bits in the kernel component. The vulnerability, identified as CVE-2007-3107, particularly affects the `restore_sigcontext` function, where a page fault or timer interrupt can occur during the `__copy_from_user` calls that write to `current->thread.fpr` and `current->thread.vr`. The vulnerability is triggered when MSR_FP and MSR_VEC are not cleared before copying into these registers, which can lead to overwriting of floating point registers if a context switch occurs during the signal handler's execution. This flaw was introduced in kernel version 2.6.2 and affects Red Hat Enterprise Linux 5 among other distributions. The impact of exploiting this vulnerability is a denial of service through system crash or significant disruption. A patch has been issued to address this issue by clearing the MSR bits before the copying process in the affected function, aligning the handling with that of the 32-bit architecture. This fix is included in the advisory RHSA-2007:0595."}]
